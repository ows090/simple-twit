(this["webpackJsonpsimple-twit"]=this["webpackJsonpsimple-twit"]||[]).push([[0],{44:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n.n(r),a=n(28),s=n.n(a),i=n(9),o=n(18),u=n(5),l=n(6),b=n.n(l),d=n(14),j=n(19),p=(n(36),n(46),n(45),{apiKey:"AIzaSyCV64HTeKTN-fLEVpL0zVuK67mTWtwAhhs",authDomain:"simple-twit.firebaseapp.com",projectId:"simple-twit",storageBucket:"simple-twit.appspot.com",messagingSenderId:"570128328467",appId:Object({NODE_ENV:"production",PUBLIC_URL:"/ows090/simple-tweet",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_APIKEY:"AIzaSyCV64HTeKTN-fLEVpL0zVuK67mTWtwAhhs",REACT_APP_AUTHDOMAIN:"simple-twit.firebaseapp.com",REACT_APP_PROJECTID:"simple-twit",REACT_APP_STORAGEBUCKET:"simple-twit.appspot.com",REACT_APP_MESSAGINGSENDERID:"570128328467",REACT_APP_APPID:"1:570128328467:web:0f53d73ca0987e01361ce6"}).APPID});j.a.initializeApp(p);var O=j.a.auth(),h=j.a.firestore(),x=j.a.storage(),f=j.a,m=n(1),g=function(){var e=Object(r.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),s=Object(i.a)(a,2),o=s[0],u=s[1],l=Object(r.useState)(""),j=Object(i.a)(l,2),p=j[0],h=j[1],x=Object(r.useState)(""),g=Object(i.a)(x,2),v=g[0],w=g[1],k=Object(r.useCallback)((function(e){var t=e.target,n=t.name,r=t.value;return"email"===n?u(r):"password"===n?h(r):void 0}),[]),C=Object(r.useCallback)(function(){var e=Object(d.a)(b.a.mark((function e(t){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),e.prev=1,!n){e.next=8;break}return e.next=5,O.createUserWithEmailAndPassword(o,p);case 5:r=e.sent,e.next=11;break;case 8:return e.next=10,O.signInWithEmailAndPassword(o,p);case 10:r=e.sent;case 11:console.log("login success message: ",r),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),console.error(e.t0),w(e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),[o,p,n]),S=Object(r.useCallback)((function(){c((function(e){return!e}))}),[]),A=Object(r.useCallback)(function(){var e=Object(d.a)(b.a.mark((function e(t){var n,r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.name,e.t0=n,e.next="google"===e.t0?4:"github"===e.t0?6:8;break;case 4:return r=new f.auth.GoogleAuthProvider,e.abrupt("break",9);case 6:return r=new f.auth.GithubAuthProvider,e.abrupt("break",9);case 8:return e.abrupt("break",9);case 9:return e.prev=9,e.next=12,O.signInWithPopup(r);case 12:c=e.sent,console.log("social login success"),console.log("accessToken:",c.credential.accessToken),console.log("user: ",c.user),e.next=22;break;case 18:e.prev=18,e.t1=e.catch(9),console.error(e.t1),w(e.t1.message);case 22:case"end":return e.stop()}}),e,null,[[9,18]])})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(m.jsxs)("div",{children:[Object(m.jsx)("span",{onClick:S,style:{cursor:"pointer"},children:n?"I want to login":"I want to sign in"}),Object(m.jsxs)("form",{onSubmit:C,children:[Object(m.jsx)("input",{type:"email",placeholder:"Email",required:!0,value:o,name:"email",onChange:k}),Object(m.jsx)("input",{type:"password",placeholder:"Password",name:"password",required:!0,onChange:k}),Object(m.jsx)("button",{type:"submit",children:n?"Sign Up":"Log In"})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("button",{name:"google",onClick:A,children:"Continue with Google"}),Object(m.jsx)("button",{name:"github",onClick:A,children:"Continue with Github"})]}),v&&Object(m.jsx)("div",{class:"error-message",style:{border:"1px solid red"},children:v})]})},v=n(22),w=function(e){var t=e.tweet,n=e.isMine,c=Object(r.useState)(!1),a=Object(i.a)(c,2),s=a[0],o=a[1],u=Object(r.useState)(""),l=Object(i.a)(u,2),j=l[0],p=l[1],O=Object(r.useCallback)(Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,window.confirm("are you sure?")){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,h.collection("tweets").doc(t.id).delete();case 6:return e.next=8,x.refFromURL(t.imgUrl).delete();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),[]),f=Object(r.useCallback)((function(){o((function(e){return!e}))}),[]),g=Object(r.useCallback)((function(e){p(e.target.value)}),[]),v=Object(r.useCallback)(function(){var e=Object(d.a)(b.a.mark((function e(n){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r=h.collection("tweets").doc(t.id),e.prev=2,e.next=5,r.update({content:j});case 5:p(""),o(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),[j,t.id]);return Object(m.jsxs)("div",{style:{borderBottom:"3px solid black",padding:"1rem",margin:"0.5rem"},children:[Object(m.jsx)("h3",{children:t.content}),t.imgUrl&&Object(m.jsx)("div",{style:{backgroundImage:"url(".concat(t.imgUrl,")"),backgroundPosition:"center",backgroundSize:"cover",width:"300px",height:"300px"}}),Object(m.jsx)("div",{children:t.userId}),n&&Object(m.jsx)("button",{onClick:O,children:"DELETE"}),n&&!s&&Object(m.jsx)("button",{onClick:f,children:"EDIT"}),s&&Object(m.jsxs)("form",{onSubmit:v,children:[Object(m.jsx)("textarea",{value:j,onChange:g}),Object(m.jsxs)("div",{children:[Object(m.jsx)("button",{type:"submit",children:"EDIT"}),Object(m.jsx)("button",{onClick:f,children:"CANCEL"})]})]})]})},k=n(48),C=function(e){var t=e.user,n=Object(r.useState)(""),c=Object(i.a)(n,2),a=c[0],s=c[1],o=Object(r.useState)([]),u=Object(i.a)(o,2),l=u[0],j=u[1],p=Object(r.useState)(null),O=Object(i.a)(p,2),f=O[0],g=O[1],C=Object(r.useCallback)((function(){g(null)}),[g]),S=Object(r.useCallback)((function(e){var t=e.target,n=t.name,r=t.value;"tweet"===n&&s(r)}),[]),A=Object(r.useCallback)((function(e){var t=e.target.files;if(t.length>1)return alert("you cannot upload file greater than 1");var n=t[0],r=new FileReader;r.onloadend=function(e){g(e.target.result)},r.readAsDataURL(n)}),[]),y=Object(r.useCallback)(function(){var e=Object(d.a)(b.a.mark((function e(n){var r,c,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),e.prev=1,!f){e.next=14;break}return c=x.ref().child("".concat(t.uid,"/").concat(Object(k.a)())),e.next=6,c.putString(f,"data_url");case 6:return i=e.sent,e.next=9,i.ref.getDownloadURL();case 9:return r=e.sent,e.next=12,h.collection("tweets").add({content:a,createdAt:Date.now(),userId:t.uid,imgUrl:r});case 12:e.next=16;break;case 14:return e.next=16,h.collection("tweets").add({content:a,createdAt:Date.now(),userId:t.uid});case 16:s(""),g(null),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(1),console.error(e.t0);case 23:case"end":return e.stop()}}),e,null,[[1,20]])})));return function(t){return e.apply(this,arguments)}}(),[a,f,t.uid]);return Object(r.useEffect)((function(){h.collection("tweets").onSnapshot((function(e){var t=e.docs.map((function(e){return Object(v.a)({id:e.id},e.data())}));j(t.sort((function(e,t){return parseInt(t.createdAt)-parseInt(e.createdAt)})))}))}),[]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("form",{onSubmit:y,children:[Object(m.jsx)("div",{children:Object(m.jsx)("input",{type:"text",name:"tweet",value:a,onChange:S,placeholder:"what's on your mind"})}),Object(m.jsxs)("div",{children:[Object(m.jsx)("input",{type:"file",accept:"image/*",onChange:A}),Object(m.jsx)("div",{children:f&&Object(m.jsx)("div",{style:{backgroundImage:"url(".concat(f,")"),backgroundPosition:"center",backgroundSize:"cover",width:"300px",height:"300px",position:"relative"},children:Object(m.jsx)("button",{style:{position:"absolute",top:"1px",right:"1px",cursor:"pointer"},onClick:C,children:"X"})})})]}),Object(m.jsx)("button",{type:"submit",children:"tweet"})]}),Object(m.jsx)("div",{children:l&&l.map((function(e){return Object(m.jsx)(w,{tweet:e,isMine:t.uid===e.userId},e.id)}))})]})},S=function(e){var t=e.user,n=e.refreshUser,c=Object(u.g)(),a=Object(r.useState)([]),s=Object(i.a)(a,2),o=s[0],l=s[1],j=Object(r.useState)(t.displayName),p=Object(i.a)(j,2),x=p[0],f=p[1],g=Object(r.useCallback)((function(e){f(e.target.value)}),[]),k=Object(r.useCallback)(function(){var e=Object(d.a)(b.a.mark((function e(r){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),x!==t.displayName){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,t.updateProfile({displayName:x});case 6:n(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),[x,t,n]),C=Object(r.useCallback)(Object(d.a)(b.a.mark((function e(){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,h.collection("tweets").where("userId","==",t.uid).orderBy("createdAt","desc").get();case 3:e.sent.forEach((function(e){n.push(Object(v.a)({id:e.id},e.data()))})),l(n);case 6:case"end":return e.stop()}}),e)}))),[t.uid]),S=Object(r.useCallback)(Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.signOut();case 2:c.replace("/");case 3:case"end":return e.stop()}}),e)}))),[c]);return Object(r.useEffect)((function(){C()}),[C]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{children:[Object(m.jsx)("div",{children:Object(m.jsx)("img",{style:{width:"100px",height:"100px",borderRadius:"50%"},src:t.photoURL,alt:"profile img"})}),Object(m.jsx)("button",{onClick:S,children:"logout"})]}),Object(m.jsxs)("form",{onSubmit:k,children:[Object(m.jsx)("input",{type:"text",value:x,onChange:g}),Object(m.jsx)("button",{type:"submit",children:"change"})]}),Object(m.jsx)("div",{children:o.map((function(e){return Object(m.jsx)(w,{tweet:e,isMine:!0},e.id)}))})]})},A=function(e){var t=e.user;return Object(m.jsx)("nav",{children:Object(m.jsxs)("ul",{children:[Object(m.jsx)("li",{children:Object(m.jsx)(o.b,{to:"/",children:"Home"})}),Object(m.jsx)("li",{children:Object(m.jsxs)(o.b,{to:"/profile",children:[t.displayName,"'s Profile"]})})]})})},y=function(e){var t=e.isLoggedIn,n=e.user,r=e.refreshUser;return Object(m.jsxs)(o.a,{children:[t&&Object(m.jsx)(A,{user:n}),Object(m.jsxs)(u.d,{children:[t?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(u.b,{path:"/",exact:!0,children:Object(m.jsx)(C,{user:n})}),Object(m.jsx)(u.b,{path:"/profile",exact:!0,children:Object(m.jsx)(S,{user:n,refreshUser:r})})]}):Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(u.b,{path:"/",exact:!0,component:g})}),Object(m.jsx)(u.a,{from:"*",to:"/"})]})]})},E=function(){var e=Object(r.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),s=Object(i.a)(a,2),o=s[0],u=s[1],l=Object(r.useCallback)((function(){var e=O.currentUser;u({displayName:e.displayName,uid:e.uid,photoURL:e.photoURL,updateProfile:function(t){return e.updateProfile(t)}})}),[]);return Object(r.useEffect)((function(){O.onAuthStateChanged((function(e){return u(e?{displayName:e.displayName,uid:e.uid,photoURL:e.photoURL,updateProfile:function(t){return e.updateProfile(t)}}:null),c(!0)}))}),[]),Object(m.jsx)(m.Fragment,{children:n?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(y,{isLoggedIn:Boolean(o),user:o,refreshUser:l}),Object(m.jsxs)("footer",{children:["\xa9 Simple Twit ",(new Date).getFullYear()]})," "]}):Object(m.jsx)("div",{children:"loading..."})})};s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(E,{})}),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.dcadc714.chunk.js.map